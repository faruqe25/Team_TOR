@using RestaurantManagementSystem.Helper
@using RestaurantManagementSystem.Areas.Customer.ViewModels
@*@model List<RestaurantManagementSystem.Areas.Admin.Models.Table>*@
﻿﻿@{

    Layout = null;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Resturant Management System</title>
    <environment include="Development">
        <link rel="stylesheet" href="~/Assets/css/bootstrap.min.css">
        <link rel="stylesheet" href="~/Assets/css/all.css">
        <link rel="stylesheet" href="~/css/site.css" />
    </environment>
    <style>


        body {
            margin: 0;
            padding: 0;
            top: 0;
            left: 0;
            width: 100%;
            background: linear-gradient(rgba(0,0,0,0.5),rgba(0,0,0,0.5)),url(/images/hermes-rivera-Ww8eQWjMJWk-unsplash.jpg);
            background-attachment: fixed;
            background-position: center;
            background-size: cover;
            background-repeat: no-repeat;
        }
    </style>
</head>
<body>
    <div class="container-fluid mt-3">
        <div class="col-12 col-sm-12 col-md-12 col-lg-10 offset-lg-1 col-xl-10 offset-xl-1 p-3 mb-2"style="background:linear-gradient(rgba(255,255,255,0.6),rgba(255,255,255,0.6));">
            <h2 class="text-center">My Food Cart</h2>
        </div>
        <div class="col-12 col-sm-12 col-md-12 col-lg-10 offset-lg-1 col-xl-10 offset-xl-1">
            <div class="row d-flex justify-content-center">
                <div class="col-12 col-sm-12 col-md-12 col-lg-8 col-xl-8"
                     style="background:linear-gradient(rgba(255,255,255,0.8),rgba(255,255,255,0.8));">
                    <div class="table-responsive">
                        <table class="table col-lg-12 col-xl-12 d-flex justify-content-center">
                            <tbody>
                                @{var a = Context.Session.Get<List<FoodCart>>("FoodS");}
                                @if (a != null)
                                {
                                    @foreach (var item in a)
                                    {
                                        <tr>
                                            <td>
                                                <img height=100 width=100 class="img-fluid mr-4" src="~/images/breakfast (1).svg" />
                                            </td>
                                            <td class="m-3">
                                                <h5>@item.FoodName</h5>
                                                <hr />
                                                <p>@item.FoodDescription</p>
                                                <p>Price: @item.FoodPrice (BDT)<input id="Ta" type="hidden" value="@item.FoodPrice" /></p>
                                            </td>
                                            <td>
                                                <div class="btn-group m-3">
                                                    <button id="Minus" class="btn btn-danger" value="-"><strong>-</strong></button>
                                                    <input id="Quantity" type="text" value="@item.Quantity" class="form-control" readonly />
                                                    <button id="Plus" class="btn btn-success" value="+"><strong>+</strong></button>
                                                </div>
                                            </td>
                                            <td>
                                                <h5>Total Price</h5>
                                                <hr />
                                                @{ var ab = item.Quantity * item.FoodPrice;}
                                                <p id="totalprice">@ab </p>(BDT)

                                            </td>
                                            <td>
                                                <a id="DeleteMe"><i class="fa fa-trash-alt mt-3" style="color:red;font-size:1.5em;"></i></a>
                                            </td>
                                            <td class="text-hide">@item.FoodItemId</td>
                                        </tr>
                                                    }
                                                    }
                        </table>
                    </div>
                    <div class="card-footer d-flex justify-content-end">
                        <button type="button" class="btn btn-dark">
                            Confirm Order
                        </button>
                    </div>
                </div>
                <div class="col-12 col-sm-12 col-md-12 col-lg-3 ml-lg-3 col-xl-3 ml-xl-3"
                     style="background:linear-gradient(rgba(255,255,255,0.8),rgba(255,255,255,0.8));">
                    <h4 class="text-center">Reserve a Table</h4>
                    <hr />
                    <div class="row d-flex justify-content-center">
                        <div class="col-2 col-sm-2 col-md-1 col-lg-3 col-xl-3">
                            <img src="~/images/table (3).svg" class="img-fluid" />
                        </div>
                        <div class="col-2 col-sm-2 col-md-1 col-lg-3 col-xl-3">
                            <img src="~/images/table (4).svg" class="img-fluid" />
                        </div>
                        <div class="col-2 col-sm-2 col-md-1 col-lg-3 col-xl-3">
                            <img src="~/images/table (5).svg" class="img-fluid" />
                        </div>
                        <div class="col-2 col-sm-2 col-md-1 col-lg-3 col-xl-3">
                            <img src="~/images/table (5).svg" class="img-fluid" />
                        </div>
                    </div>
                    <div class="card-footer d-flex justify-content-end mt-auto">
                        <button type="button" class="btn btn-dark" data-toggle="modal" data-target="#exampleModalCenter">
                            Reserve
                        </button>
                        <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                            <div class="modal-dialog modal-dialog-centered" role="document">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="text-center" id="exampleModalLongTitle">Set Reservation Schedule</h5>
                                        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                            <span aria-hidden="true">&times;</span>
                                        </button>
                                    </div>
                                    <div class="modal-body">
                                        <form asp-area=""asp-controller=""asp-action=""method="post">
                                            <div class="form-inline">
                                                <div class="form-group">
                                                    <label>Reserve From</label>
                                                    <input class="form-control" type="time" />
                                                </div>
                                                <div class="form-group ml-auto">
                                                    <label>Reserve To</label>
                                                    <input class="form-control" type="time" />
                                                </div>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-danger" data-dismiss="modal">Cancel</button>
                                        <button type="submit" class="btn btn-dark">Confirm</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script type="text/javascript">

        $(document).ready(function () {
            $("[id^=Quantity]").each(function () {
                var C = $(this).closest("tr").find("#Quantity").val()
                if (C == 1) {
                    $(this).closest("tr").find("#Minus").attr("disabled", true);
                }
            });
        });

        $("table.table-responsive").on("click", "#DeleteMe", function (event) {
            var FoodId = $(this).closest("tr").find('td:eq(5)').text();
            var url = "/Home/DeleteCart";
            $.getJSON(url, { id: FoodId }, function (data) {
            });
            $(this).closest("tr").remove();

        });

        $("button").click(function () {
            var value = $(this).attr("value");
            if (value == "+") {
                var Q = $(this).closest("tr").find("#Quantity").val();
                var TotalQuantity = Number(Q) + Number(1);
                $(this).closest("tr").find("#Quantity").val(TotalQuantity);

                if (TotalQuantity > 1) {

                    $(this).closest("tr").find('#Minus').removeAttr("disabled");
                }
                var FoodId = $(this).closest("tr").find('td:eq(5)').text();
                var url = "/Home/SetCartValueUpdated";
                $.getJSON(url, { id: FoodId, Quantity: TotalQuantity }, function (data) {
                    console.log(data);
                });
                var FoodPrice = $(this).closest("tr").find("#Ta").val();
                var CalculatedTotalPrice = Number(FoodPrice) * Number(TotalQuantity)
                $(this).closest("tr").find("#totalprice").html(CalculatedTotalPrice);

            }
            else {

                var FoodId = $(this).closest("tr").find('td:eq(5)').text();
                var tt = $(this).closest("tr").find("#Ta").val();

                var Q = $(this).closest("tr").find("#Quantity").val();
                var TotalQuantity = Number(Q) - Number(1);

                $(this).closest("tr").find("#Quantity").val(TotalQuantity);

                $(this).closest("tr").find("#totalprice").html(Number(tt) * Number(TotalQuantity));


                if (t == 1) {
                    $(this).closest("tr").find("#Minus").attr("disabled", true);
                }

                $(this).closest("tr").find("#totalprice").html(Number(tt) * Number(TotalQuantity));

                var url = "/Home/SetCartValueUpdated";
                $.getJSON(url, { id: FoodId, Quantity: TotalQuantity }, function (data) {

                });
            }
        });

    </script>


</body>
</html>


